 <!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="koronavirusas, lietuva, lietuvoje,
Koronaviruso atveju kiekis lietuvoje, pasaulyje, kiekis, skaicius,
korono virusas, pandemija, 2020">
<meta name="author" content="Danas Mikelionis">
<meta name="description" content="Lentelė, rodanti
 kur kiek koronaviruso atvejų.">
<title>Korono viruso atvejai</title>
</head>

<body>
 <h1>Korono viruso atvejai (naudojausi: https://rapidapi.com/api-sports/api/covid-193).</h1>

 <h3 id="lithuania"></h3>

 <input id="filter-countries" placeholder="Čia galite įvesti šalį(Angliškai)"></input>
<table id="table">
<tr>
	<th>Šalis</th>
	<th>Iš viso atvejų</th>
	<th>Iš viso mirčių</th>
	<th>Pasveiko</th>
</tr>
</table>

<p>Naudojausi: https://rapidapi.com/api-sports/api/covid-193.</p>
</body>

</html>

<script>

var data = null;
var tableTag = document.getElementById('table');

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.addEventListener("readystatechange", function () {
	if (this.readyState === this.DONE) {
		console.log(JSON.parse(this.responseText));
		console.log(JSON.parse(this.responseText).response[0].cases.total);
	}
});

xhr.open("GET", "https://covid-193.p.rapidapi.com/statistics?country=lithuania");
xhr.setRequestHeader("x-rapidapi-host", "covid-193.p.rapidapi.com");
xhr.setRequestHeader("x-rapidapi-key", "116908dfb6msh3f97dbaf0aa4af8p1fcef7jsn502b466da50c");

xhr.send(data);



var data = null;

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener("readystatechange", function () {
	if (this.readyState === this.DONE) {
		let responseNormal = JSON.parse(this.responseText).response;
		responseNormal.sort((r1, r2) => r2.cases.total - r1.cases.total);
		console.log(responseNormal);

		for (let i = 0; i < responseNormal.length; i++) {
			let responseLine = responseNormal[i];

			let trNew = document.createElement('tr');

			let tdNew = document.createElement('td');
			let tdNew2 = document.createElement('td');
			let tdDeathsTotal = document.createElement('td');
			let tdRecovered = document.createElement('td');

			tdNew.textContent = responseLine.country;

			if (tdNew.textContent == 'All') {
				tdNew.textContent = 'Visos Šalys';
				trNew.style.color = 'red';
			}

			tdNew2.textContent = responseLine.cases.total;
			tdDeathsTotal.textContent = responseLine.deaths.total;
			tdRecovered.textContent = responseLine.cases.recovered;

			trNew.appendChild(tdNew);
			trNew.appendChild(tdNew2);
			trNew.appendChild(tdDeathsTotal);
			trNew.appendChild(tdRecovered);

			if (responseLine.country == 'Lithuania') {
				trNew.style.color = 'red';
				trNew.style.border = '3px solid blue';
				tdNew.textContent += '/Lietuva';
				document.getElementById('lithuania').textContent = 'Lietuvoje iš viso atvejų: ' + responseLine.cases.total + '. Šiuo metu serga: '
				+ responseLine.cases.active + '. Iš viso mirčių: ' + responseLine.deaths.total + '. Iš viso pasveiko: ' + responseLine.cases.recovered + '.';
			}

			tableTag.appendChild(trNew);
		}
		document.getElementById('filter-countries').style.display = 'block';

	}
});

xhr.open("GET", "https://covid-193.p.rapidapi.com/statistics");
xhr.setRequestHeader("x-rapidapi-host", "covid-193.p.rapidapi.com");
xhr.setRequestHeader("x-rapidapi-key", "116908dfb6msh3f97dbaf0aa4af8p1fcef7jsn502b466da50c");

xhr.send(data);

let filterCountriesInput = document.getElementById('filter-countries');
filterCountriesInput.addEventListener('input', function() {
	let tableLines = tableTag.childNodes;
	let textInputed = filterCountriesInput.value;
	filterCountriesInput.value = textInputed.toUpperCase();

	//i start 3, nes pirma kazkas ten, vėliau stulpelių pavadinimai, vėliau visos šalys ir tik tada šalys po vieną
	for (let i = 3; i < tableLines.length; i++) {
		let countryName = tableLines[i].firstElementChild.innerText;
			
		if (textInputed == '' || countryName.toLowerCase().includes(textInputed.toLowerCase())) {
			tableLines[i].style.display = 'table-row';
		} else {
			tableLines[i].style.display = 'none';
		}
	}
});
</script>

<style>
table, td, th {
	border: 2px solid black;
	font-size: 1.2em;
	font-weight: 600;
	border-collapse: collapse;
}

td, th {
	padding: 4px;
}

tr:hover {
	background-color: black;
	color: white;
	cursor: pointer;
}

th {
	width: 25%;
}

table {
	width: 100%;
}

h1, h2, h3, h4, h5, h6 {
	text-align: center;
}

#filter-countries {
	width: 40%;
	display: none;
	font-size: 1.3em;
}

::placeholder {
	font-size: 1.3em;
}
</style>
